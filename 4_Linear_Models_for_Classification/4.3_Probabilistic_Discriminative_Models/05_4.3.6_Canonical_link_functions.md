# 05_4.3.6_Canonical_link_functions

"""
Lecture: 4_Linear_Models_for_Classification/4.3_Probabilistic_Discriminative_Models
Content: 05_4.3.6_Canonical_link_functions
"""

### 详解PRML中的4.3.6节：典型链接函数

《模式识别与机器学习》（Pattern Recognition and Machine Learning, PRML）是由Christopher M. Bishop所著的一本经典教材，其中第4章涵盖了线性分类模型的内容。在第4.3节，作者介绍了概率判别模型（Probabilistic Discriminative Models）。具体来说，第4.3.6节探讨了典型链接函数（Canonical Link Functions）。以下是对这一节内容的详细分析。

### 典型链接函数的背景

在广义线性模型（Generalized Linear Models, GLM）中，链接函数（Link Function）用于将线性预测变量和目标变量之间的关系映射到一个合适的范围。典型链接函数是一类特殊的链接函数，它们使得对数似然函数的导数形式变得简单，从而简化参数估计和模型优化。

### 典型链接函数的定义

典型链接函数是与指数族分布相对应的链接函数。对于指数族分布，其概率密度函数或概率质量函数可以表示为：

$$ p(t|\eta) = h(t) \exp(\eta t - A(\eta)) $$

其中，$\eta$ 是自然参数（Natural Parameter），$A(\eta)$ 是对数分区函数（Log Partition Function），$h(t)$ 是标准化常数。

在广义线性模型中，线性预测变量 $\eta$ 和期望值 $\mu$ 之间的关系由链接函数 $g$ 来描述：

$$ \eta = g(\mu) $$

当链接函数 $g$ 是对数分区函数 $A(\eta)$ 的导数时，称其为典型链接函数：

$$ g(\mu) = \frac{dA(\eta)}{d\eta} $$

### 线性回归中的典型链接函数

对于线性回归模型，假设噪声服从高斯分布。其对数似然函数为：

$$ \ln p(t|\mu, \sigma^2) = -\frac{N}{2} \ln(2\pi\sigma^2) - \frac{1}{2\sigma^2} \sum_{n=1}^{N} (t_n - \mu_n)^2 $$

对于高斯分布，其分区函数为：

$$ A(\eta) = \frac{\eta^2}{2} $$

因此，对应的典型链接函数为：

$$ g(\mu) = \mu $$

这表明，在高斯分布假设下，线性回归模型的链接函数是恒等函数。

### 逻辑回归中的典型链接函数

对于逻辑回归模型，假设目标变量服从伯努利分布。其对数似然函数为：

$$ \ln p(t|\mu) = \sum_{n=1}^{N} \{ t_n \ln \mu_n + (1 - t_n) \ln (1 - \mu_n) \} $$

对于伯努利分布，其分区函数为：

$$ A(\eta) = \ln(1 + \exp(\eta)) $$

因此，对应的典型链接函数为：

$$ g(\mu) = \ln \frac{\mu}{1 - \mu} $$

这表明，在伯努利分布假设下，逻辑回归模型的链接函数是对数几率（Logit）函数。

### 多类别逻辑回归中的典型链接函数

对于多类别逻辑回归模型，假设目标变量服从多项分布。其对数似然函数为：

$$ \ln p(t|\mu) = \sum_{n=1}^{N} \sum_{k=1}^{K} t_{nk} \ln \mu_{nk} $$

对于多项分布，其分区函数为：

$$ A(\eta) = \ln \left( \sum_{k=1}^{K} \exp(\eta_k) \right) $$

因此，对应的典型链接函数为：

$$ g(\mu) = \ln \frac{\mu_k}{\mu_1} $$

这表明，在多项分布假设下，多类别逻辑回归模型的链接函数是对数比率函数。

### 典型链接函数的优点

1. **简化计算**：典型链接函数使得对数似然函数的导数形式变得简单，从而简化参数估计和模型优化。
2. **广泛应用**：典型链接函数广泛应用于各种广义线性模型中，包括线性回归、逻辑回归和多类别逻辑回归等。

### 结论

通过以上分析可以看出，典型链接函数在广义线性模型中具有重要的地位。它们不仅简化了模型的参数估计和优化过程，而且在各种实际应用中表现出色。掌握典型链接函数的理论和应用，有助于我们在实际问题中选择合适的模型和算法，提高分类和预测的准确性。