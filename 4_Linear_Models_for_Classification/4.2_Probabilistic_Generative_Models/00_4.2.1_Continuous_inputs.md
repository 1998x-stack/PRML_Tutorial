# 00_4.2.1_Continuous_inputs

"""
Lecture: 4_Linear_Models_for_Classification/4.2_Probabilistic_Generative_Models
Content: 00_4.2.1_Continuous_inputs
"""

### 深入解析PRML中的4.2.1节：连续输入

《模式识别与机器学习》（Pattern Recognition and Machine Learning, PRML）是由Christopher M. Bishop所著的一本经典教材，其中第4章涵盖了线性分类模型的内容。在第4.2节，作者介绍了概率生成模型（Probabilistic Generative Models）。具体来说，第4.2.1节探讨了连续输入的情况。以下是对这一节内容的详细分析。

#### 概率生成模型的背景

概率生成模型是一类通过联合概率分布建模输入数据和类别标签的方法。与判别模型不同，生成模型可以直接生成数据样本，并且在处理缺失数据、异常检测和密度估计等任务中具有优势。在连续输入的情况下，我们通常假设数据服从某种连续概率分布，比如多元高斯分布。

#### 高斯判别分析（Gaussian Discriminant Analysis, GDA）

在连续输入的情境下，常用的一种生成模型是高斯判别分析。GDA假设对于每个类别 $C_k$，输入数据 $x$ 服从一个多元高斯分布，即：

$$ p(x|C_k) = \mathcal{N}(x|\mu_k, \Sigma_k) $$

其中，$\mu_k$ 是类别 $C_k$ 的均值向量，$\Sigma_k$ 是协方差矩阵。根据贝叶斯定理，我们可以写出类别的后验概率：

$$ p(C_k|x) = \frac{p(x|C_k)p(C_k)}{p(x)} $$

#### 连续输入的处理方法

在实际应用中，我们需要通过最大似然估计（MLE）或贝叶斯估计来确定模型参数 $\mu_k$ 和 $\Sigma_k$。以下是具体步骤：

1. **计算先验概率**：先验概率 $p(C_k)$ 通常由类别 $C_k$ 的样本比例来估计，即：

   $$ p(C_k) = \frac{N_k}{N} $$

   其中，$N_k$ 是类别 $C_k$ 的样本数，$N$ 是总样本数。

2. **估计均值向量和协方差矩阵**：
   - **均值向量**：类别 $C_k$ 的均值向量 $\mu_k$ 可以通过对该类别的样本取平均值来估计：
   
     $$ \mu_k = \frac{1}{N_k} \sum_{i \in C_k} x_i $$
   
   - **协方差矩阵**：协方差矩阵 $\Sigma_k$ 可以通过该类别样本的协方差来估计：
   
     $$ \Sigma_k = \frac{1}{N_k} \sum_{i \in C_k} (x_i - \mu_k)(x_i - \mu_k)^T $$

3. **分类决策**：根据上述参数估计，我们可以计算每个类别的后验概率，并选择后验概率最大的类别作为预测类别：

   $$ \hat{C} = \arg\max_{k} p(C_k|x) $$

#### 生成模型与判别模型的关系

在PRML中，作者还探讨了生成模型与判别模型之间的关系。具体来说，生成模型通过建模数据分布 $p(x|C_k)$ 和先验 $p(C_k)$，然后根据贝叶斯定理推导出后验概率 $p(C_k|x)$。相比之下，判别模型直接建模后验概率 $p(C_k|x)$，例如逻辑回归（Logistic Regression）。

#### 高斯判别分析的优势与局限

- **优势**：
  - 能够处理缺失数据和异常检测。
  - 在样本量较小时，生成模型通常比判别模型表现更好，因为生成模型利用了数据的完整分布信息。
  - 可以用于密度估计和样本生成。

- **局限**：
  - 当类别的协方差矩阵差异较大时，高斯判别分析的效果可能较差。
  - 对数据的分布假设较强，例如假设数据服从高斯分布，可能在实际中不完全成立。

#### 应用场景

高斯判别分析广泛应用于以下领域：
- **医学诊断**：通过患者的生理指标预测疾病类别。
- **金融风控**：基于客户的交易记录预测信用风险。
- **图像分类**：在图像特征空间中进行类别判别。

---