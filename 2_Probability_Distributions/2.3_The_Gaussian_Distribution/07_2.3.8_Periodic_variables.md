# 07_2.3.8_Periodic_variables

"""
Lecture: 2_Probability_Distributions/2.3_The_Gaussian_Distribution
Content: 07_2.3.8_Periodic_variables
"""

### PDF 探索和详细分析

#### 周期变量（Periodic variables）

在2.3.8节中，讨论了如何处理周期变量，这类变量在一些实际应用中非常重要。高斯分布虽然在很多场景下都非常有用，但在处理周期变量时并不合适。周期变量的一个常见例子是某个地理位置的风向测量，或者是24小时内的时间分布。

#### 定义与背景

1. **周期变量的定义**：
   周期变量可以用角度坐标表示，通常在 $0 \leq \theta < 2\pi$ 范围内。例如，风向可以在360度内变化，而时间可以在24小时内循环。这些变量的特点是周期性，即它们在达到一个最大值后会重置为最小值并重新开始。例如，风向在360度后会回到0度，时间在24小时后会回到0小时。

2. **常规方法的局限性**：
   如果使用常规的高斯分布来处理周期变量，会导致结果严重依赖于原点的选择。例如，假设有两个观测值 $\theta_1 = 1^\circ$ 和 $\theta_2 = 359^\circ$，如果选择原点为0度，则样本均值为180度，标准差为179度。而如果选择原点为180度，则均值为0度，标准差为1度。这显然是不合理的，因此需要一种特殊的方法来处理周期变量。

#### 处理周期变量的方法

1. **单位圆上的表示**：
   可以将周期变量表示为单位圆上的点，并使用二维单位向量 $ x_n $ 来表示每个观测值 $\theta_n$。这些向量的模长为1，即 $ \|x_n\| = 1 $。这样，均值可以通过向量的平均值来计算，并转换为对应的角度。

   计算步骤如下：
   $$
   \bar{x} = \frac{1}{N} \sum_{n=1}^{N} x_n
   $$
   其中，$\bar{x}$ 是所有向量的平均值。然后，通过求平均向量对应的角度来找到均值 $\theta$：
   $$
   \theta = \tan^{-1} \left( \frac{\sum_{n=1}^{N} \sin \theta_n}{\sum_{n=1}^{N} \cos \theta_n} \right)
   $$

2. **von Mises 分布**：
   为了更好地处理周期变量，可以使用von Mises分布，它是一种高斯分布的周期性推广。von Mises分布的概率密度函数为：
   $$
   p(\theta|\theta_0, m) = \frac{1}{2\pi I_0(m)} \exp \{m \cos(\theta - \theta_0)\}
   $$
   其中，$ I_0(m) $ 是第一类零阶贝塞尔函数，$ \theta_0 $ 是分布的均值，$ m $ 是浓度参数，类似于高斯分布中的精度（方差的倒数）。

   von Mises分布的特点是：
   - 具有周期性，即 $ p(\theta + 2\pi) = p(\theta) $。
   - 当 $ m $ 较大时，分布在均值 $\theta_0$ 附近高度集中，类似于高斯分布。

3. **多峰分布**：
   虽然von Mises分布通常是单峰的，但通过混合多个von Mises分布，可以构建多峰分布，从而处理更复杂的周期变量数据。例如，风向在某些季节可能有两个主要方向，这时可以使用两个von Mises分布的混合来建模。

### 总结

处理周期变量时，传统的高斯分布方法会导致结果严重依赖于坐标原点的选择。通过将周期变量表示为单位圆上的点，并使用von Mises分布，可以更合理地处理周期性数据。这种方法不仅可以提供无偏的均值估计，还可以通过混合多个von Mises分布来处理多峰数据。