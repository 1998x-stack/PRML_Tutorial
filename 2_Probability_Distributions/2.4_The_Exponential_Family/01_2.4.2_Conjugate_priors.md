# 01_2.4.2_Conjugate_priors

"""
Lecture: 2_Probability_Distributions/2.4_The_Exponential_Family
Content: 01_2.4.2_Conjugate_priors
"""

### PDF 探索和详细分析

#### 共轭先验（Conjugate Priors）

在2.4.2节中，介绍了共轭先验的概念及其在贝叶斯推断中的应用。共轭先验是指在贝叶斯分析中，先验分布和后验分布具有相同的形式，这使得计算后验分布变得更加简便。

#### 定义与背景

1. **共轭先验的概念**：
   对于给定的似然函数 $ p(x|\eta) $，我们可以寻找一个先验分布 $ p(\eta) $，使得后验分布 $ p(\eta|x) $ 与先验分布 $ p(\eta) $ 具有相同的函数形式。这样，计算后验分布时就不需要处理复杂的积分。

2. **指数族分布的共轭先验**：
   对于任何指数族分布 $ p(x|\eta) $，存在一个共轭先验可以写成如下形式：
   $$
   p(\eta|\chi, \nu) = f(\chi, \nu)g(\eta)^\nu \exp\{\nu \eta^T \chi\}
   $$
   其中：
   - $ f(\chi, \nu) $ 是归一化系数
   - $ g(\eta) $ 是与指数族分布中的函数相同的函数

3. **共轭性的验证**：
   通过将上述先验分布与似然函数相乘，可以得到后验分布的形式：
   $$
   p(\eta|X, \chi, \nu) \propto g(\eta)^{\nu+N} \exp\left\{\eta^T \left( \sum_{n=1}^{N} u(x_n) + \nu \chi \right)\right\}
   $$
   这表明，后验分布的形式与先验分布相同，从而确认了共轭性。

#### 参数解释

1. **伪观测数**：
   参数 $ \nu $ 可以解释为先验中的有效伪观测数，即在先验分布中，每个伪观测的充分统计量值为 $ \chi $。

2. **常见的共轭先验**：
   - **伯努利分布**：共轭先验是贝塔分布
   - **高斯分布**：对于均值的共轭先验是高斯分布，对于精度的共轭先验是Wishart分布

#### 应用示例

1. **伯努利分布的贝塔先验**：
   - 伯努利分布的似然函数为 $ p(x|\theta) = \theta^x (1 - \theta)^{1-x} $
   - 共轭先验为贝塔分布 $ p(\theta|\alpha, \beta) = \frac{\theta^{\alpha-1} (1 - \theta)^{\beta-1}}{B(\alpha, \beta)} $
   - 后验分布仍然是贝塔分布

2. **高斯分布的高斯-Wishart先验**：
   - 对于已知协方差的高斯分布，均值的共轭先验是高斯分布
   - 对于已知均值的高斯分布，协方差的共轭先验是Wishart分布

### 总结

共轭先验在贝叶斯分析中具有重要的作用，通过选择合适的共轭先验，可以极大简化后验分布的计算。指数族分布的共轭先验具有统一的形式，使得参数估计和推断过程更加高效。